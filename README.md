# Action Scripter （键鼠执行器） 

- **项目名称**  

  键鼠执行器

- **用途** 

  程序通过执行动作列表（ActionList）来实现模拟用户的键盘鼠标操作，轻松解放双手。

- **安装说明**：

  1. **通过源代码执行**

     源代码运行在**github**中下载的源码可以直接在ide中打开之后执行，在ide中打开之后直接运行主类  

     > club.pineclone.Main

     即可直接运行设定的GUI程序，在GUI面板提供了执行，录制，编辑行为脚本  等功能。此项目为Maven项目，使用的Maven版本为3.6.3，推荐使用相同或高于该版本号的Maven进行项目构建，项目的pom.xml文件包含了项目启动运行所需要的依赖配置信息，在ide打开后会根据配置文件自动构建。

  2. **安装包装软件后执行**

     可以通过下载给定的Setup安装器，未来可能会提供url下载链接，运行安装器可以直接完成安装，由于项目由**Java**编写，故安装器会在安装目录中附加安装JVM，导致安装所需空间实际上远大于程序本身所用的空间。

- **使用说明**

  1. **执行界面(Launch)**

     此界面提供了包括录制，选择，保存，执行脚本的功能，采用**录制 -> 提交 -> 执行**的逻辑，首先通过**【录制】**按钮完成响应动作列表的录制，点击**【提交】**可将录制的动作列表提交至执行器当中，之后点击**【执行】**即可执行提交的脚本动作。

     对于希望得到保存的动作列表，亦提供了保存的功能，在完成**录制**之后，点击**【保存】**即可将录制的动作列表保存到指定的目录当中，点击**【选择】**可以选择一个保存的动作列表，随后点击**【执行】**即可执行选定的动作列表。

  2. **编辑界面(Editor)**

     编辑界面提供了一个可交互的界面，在编辑界面当中用户可以选择**一个或多个**保存的动作列表，对这些动作进行**裁剪**，**编辑**，**拼接**，以期望程序能够在监听到响应的状况时给出期望的反应。另外编辑界面还提供了**动作列表制作器**，通过**动作列表制作器**，可以直接通过添加相应的操作，制作出期望的动作列表。通过编辑界面用户可以对已录制的动作列表进行调校，制作动作列表等，从而让用户能够制作出期望的动作脚本。

  3. 更多功能界面将会在未来实现。

- **关于测试开发**

  由于**文件初始化**的关系，

  > club.pineclone.utils.FileUtils

  在程序运行的过程中执行很重要的作用，其中的<u>initializeFile()</u>方法负责在程序启动的准备阶段完成对资源文件的加载工作，包括对配置文档，图片/文件流，应用程序家目录的初始化工作，因此如果在程序启动之前没有调用此方法将会导致诸如**NullPointerException**的错误，但是并不推荐直接调用此方法，在项目中提供了一个**Driver**类：

  > club.pineclone.Driver

  其可以负责完成对类的初始化工作，倘若需要在一个独立的类中启动主界面，那么只需要简单的加载这个类即可，可以采用静态代码块的方式完成加载，只需要在类中键入:

  ```java
  static {
      try {
          Class.forName("club.pineclone.Driver");
      } catch (ClassNotFoundException e) {
          e.printStackTrace();
      }
  }
  ```

  即可在程序启动前执行类的初始化工作，若需要启动主界面，只需要像如下书写即可：

  ```Java
  public static void main(String[] args) {
      SwingUtilities.invokeLater(() -> {
         	var frame = new MainFrame();
          frame.setVisible(true);
      });
  }
  ```

  运行就可以看到主界面啦。

- **历史版本**

  **1.0版**：0.0很简单的一个版本，提供了很基础的功能，包括**动作列表的录制**、**动作列表的提交执行**，不过还是很轻量			化的，当前只有这一个版本，目前也在尝试添加新的功能，也许不久就会有新版本了。

- **文件结构（一些开发的文档**

  - **api**

    **【应用程序开发接口包】** 提供了对app全局适用的应用程序开发接口的包。

   - **concurrent**

     **【并发包】**，其中提供了几个默认的线程池，包括：  

     <u>GuiThreaPool</u>：Gui的默认线程池，负责Gui界面的渲染任务的执行，例如在用户选择新的语言时刷新gui所有控件文本时会使用到该线程池。  

     <u>TaskThreadPool</u>：主任务线程池，负责处理应用程序的主任务，包括动作的执行等。

   - **gui**

     **【界面包】**，程序的gui界面采用Java的Swing进行实现，包中提供了界面加载的逻辑，采用**状态模式**结合**事件驱动模型**构建出界面的行为模式框架，其中的目录如下：

     <u>event</u>：负责管理界面的事件的包，当界面产生了事件对象时，会将事件对象传递给包中的<u>PropertyChangeEventDispatcher</u>，其负责将受到的事件传递给注册了对应事件的监听器对象，这些对象再负责执行对应的逻辑。  

     <u>status</u>：gui主界面采用面板的形式构成，通过向主界面（MainFrame）添加<u>JTabbedPane</u>，JTabbedPane中添加不同的JPanel，而不同的JPanel则对应实现了不同的功能的逻辑，实现了gui的主界面，status包负责收录这些子界面的状态，维持子界面的正常工作逻辑。  

     <u>context</u>：上下文所用的包，负责收录各个界面的上下文对象，结合状态类所使用的包，对子界面的工作逻辑进行规划。  

   - **process**

     **【过程包】**主要定义了动作列表的执行逻辑，采用**录制/制作 -> 提交 -> 执行**的逻辑进行工作，包中为动作列

     表的**制作/录制**以及动作列表的**执行**定义了相关的接口和类：

     <u>monitor</u>：**录制器的基类**，若希望动作列表通过录制得到，那么会通过使用这个类的逻辑，录制器通过引入第三方库<u>org.jnativehook</u>从而实现了全局监听的功能，可以在激活之后监听用户的键盘或是鼠标输入，将输入封装成为动作列表并储存下来。  

     <u>executor</u>：**执行器的基类**，若希望执行一段动作列表，那么会使用到这个类，执行器类通过向其提交一段**完整**的动作列表，其提供的launch方法可用于执行提交的动作列表。  

     <u>action</u>：**动作的基类**，其中定义了一系列的可供执行器执行，以及录制器封装的动作，包括鼠标点击，键盘输入等，还有部分动作可用于添加监听器，可以用于在未来对某些情况下的行为进行判断。  

     <u>processor</u>：**流程器的基类**，其聚合了一个录制器和一个执行器，用于实现基于**录制 -> 提交 -> 执行**的逻辑，此外它亦提供了方法能够通过文件流的形式向其输入以文件为形式的动作列表，它将对正确格式的动作列表文件进行解析，并提供执行的方法执行动作列表。不同的流程器提供了不同的实现，它们可能会有自己独特的功能。

   - **utils**

     **【工具包】**定义了一系列工具类，它们当中包含许多**静态方法**以及**常量**，用于辅助应用程序的逻辑执行，包括

     以下几个部分：

     <u>i18n</u>：负责对程序进行本地化工作的工具类，用于对一些文本，输出实现本地化工作，程序提供了一个很容易实现的本地化机制，当希望为程序新添加一种本地化语言，只需要在程序gui界面的菜单栏中打开对应存储本地化properties文件的目录，将原有的本地化properties文件复制一份，重命名为对应语言，将其中的键值对进行更改之后在程序中的点击**重新加载可用语言**菜单按钮即可完成对语言的加载。  

     <u>FileUtils</u>：提供了程序的文件初始化程序，在程序运行前需要需要调用其中的**initializeFile**方法加载所有程序所需要的资源文件，包括图片资源，本地化语言资源以及配置文件资源，这一点非常重要，倘若执行主界面之前没有执行此方法将会导致诸如NullPointerException等错误。  

     <u>GuiUtils</u>：提供gui相关的工具静态方法，用于操作gui控件或是界面。例如确定控件的中心，相对位置，读取资源文件流等。
  
     <u>KeyUtils</u>：负责维持程序的快捷键，此部分的功能实际上与<u>FileUtils</u>有一定程度上的耦合和重复，虽然很不情愿这么做，但是考虑当它们还是负责了不同的功能，还是决定如此分类，KeyUtils会在一定程度上依赖FileUtils生成配置文件等，在程序运行时负责构建生成相应的快捷键，方便用户操作。   

   - **resources**

     收录了程序所需要用到的资源文件，包括默认的本地化文件以及一些图片。  

     

- **作者信息**

  Pineclone